# ะััะธัะตะบัััะฐ ัะฟัะฐะฒะปะตะฝะธั ัะฐัะดะฒะตัะพะผ RAMS Interactive Hub

## ะะฑะทะพั ัะธััะตะผั

ะกะธััะตะผะฐ ัะฟัะฐะฒะปะตะฝะธั ัะฐัะดะฒะตัะพะผ ะดะปั ะธะฝัะตัะฐะบัะธะฒะฝัั ะผะฐะบะตัะพะฒ ะฝะตะดะฒะธะถะธะผะพััะธ RAMS Global. ะฃะฟัะฐะฒะปะตะฝะธะต ะพัะฒะตัะตะฝะธะตะผ ะฟัะพะตะบัะพะฒ (WS2812B LED), ะฐะบััะฐัะพัะฐะผะธ (ะฟะพะดัะตะผะฝะธะบะธ, ะบัััะธ) ะธ ะดััะณะธะผะธ ัะปะตะผะตะฝัะฐะผะธ ัะตัะตะท ESP32 ะฟะพ WiFi.

---

## ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั

### 1. **Electron/Next.js ะฟัะธะปะพะถะตะฝะธะต** (Frontend/Backend)
- **ะะพะปั**: ะะฝัะตััะตะนั ัะฟัะฐะฒะปะตะฝะธั, ะพัะฟัะฐะฒะบะฐ ะบะพะผะฐะฝะด ะฝะฐ ESP32
- **ะขะตัะฝะพะปะพะณะธะธ**: Next.js, React, Electron, SerialPort, WiFi HTTP
- **ะะฐัะฟะพะปะพะถะตะฝะธะต**: `/lib/hardware/wifi.ts`, `/lib/hardware/serial.ts`

### 2. **ESP32 ะผะธะบัะพะบะพะฝััะพะปะปะตั**
- **ะะพะปั**: ะฆะตะฝััะฐะปัะฝัะน ะบะพะฝััะพะปะปะตั ัะฐัะดะฒะตัะฐ
- **ะคัะฝะบัะธะธ**:
  - ะะพะปััะตะฝะธะต ะบะพะผะฐะฝะด ะฟะพ WiFi (HTTP Server)
  - ะฃะฟัะฐะฒะปะตะฝะธะต WS2812B LED ะปะตะฝัะฐะผะธ
  - ะฃะฟัะฐะฒะปะตะฝะธะต ัะตะปะต ะดะปั 12ะ ะฐะบััะฐัะพัะพะฒ
  - ะะฑัะฐะฑะพัะบะฐ ัะพััะพัะฝะธะน ะธ ัััะตะบัะพะฒ
- **WiFi**: Access Point ะธะปะธ Station mode
- **IP**: ะกัะฐัะธัะตัะบะธะน (ะฟะพ ัะผะพะปัะฐะฝะธั 192.168.1.100)

### 3. **WS2812B ะฐะดัะตัะฝัะต LED ะปะตะฝัั**
- **ะะพะปั**: ะะพะดัะฒะตัะบะฐ ะผะฐะบะตัะพะฒ ะฟัะพะตะบัะพะฒ
- **ะฅะฐัะฐะบัะตัะธััะธะบะธ**:
  - ะะฐะฟััะถะตะฝะธะต: 5V
  - ะขะธะฟ ะดะฐะฝะฝัั: 1-wire protocol
  - ะฃะฟัะฐะฒะปะตะฝะธะต: FastLED ะฑะธะฑะปะธะพัะตะบะฐ
- **ะะพะดะบะปััะตะฝะธะต**: GPIO pin โ Data line

### 4. **ะะตะปะต ะผะพะดัะปะธ** (ะดะปั 12ะ ะฝะฐะณััะทะบะธ)
- **ะะพะปั**: ะะพะผะผััะฐัะธั ะผะพัะฝัั 12ะ ััััะพะนััะฒ
- **ะขะธะฟั**:
  - ะะดะฝะพะบะฐะฝะฐะปัะฝัะต ัะตะปะต (ะพัะฒะตัะตะฝะธะต)
  - ะะฒััะบะฐะฝะฐะปัะฝัะต ัะตะปะต (ะฐะบััะฐัะพัั ะฒะฒะตัั/ะฒะฝะธะท)
- **ะะพะดะบะปััะตะฝะธะต**: GPIO โ Relay IN pin

### 5. **12ะ ะะบััะฐัะพัั** (Linear Actuators)
- **ะะพะปั**: ะะตัะฐะฝะธัะตัะบะพะต ะฟะตัะตะผะตัะตะฝะธะต ัะปะตะผะตะฝัะพะฒ ะผะฐะบะตัะฐ (ะบัััะธ, ะปะธััั)
- **ะฃะฟัะฐะฒะปะตะฝะธะต**: H-Bridge ะธะปะธ ัะตะปะต ะดะปั ะธะทะผะตะฝะตะฝะธั ะฟะพะปััะฝะพััะธ
- **ะะธัะฐะฝะธะต**: ะะฝะตัะฝะธะน 12ะ ะธััะพัะฝะธะบ ะฟะธัะฐะฝะธั

---

## ะััะธัะตะบัััะฐ ะบะพะผะผัะฝะธะบะฐัะธะธ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   Electron + Next.js Application       โ
โ   (Windows/Mac)                        โ
โ                                        โ
โ   WiFiHardwareService                  โ
โ   - sendCommand()                       โ
โ   - ping()                              โ
โโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
                โ HTTP POST /command
                โ WiFi (192.168.1.x)
                โ
โโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           ESP32                        โ
โ   Web Server (AsyncWebServer)          โ
โ   - Handle /command endpoint           โ
โ   - Parse JSON commands                โ
โ   - Route to hardware controllers      โ
โ                                        โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ   โ  LED Controller (FastLED)       โ โ
โ   โ  - Project lighting effects     โ โ
โ   โ  - Animations (fade, pulse)     โ โ
โ   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ โ
โ               โ                        โ
โ   โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโ โ
โ   โ  Relay Controller               โ โ
โ   โ  - On/Off control               โ โ
โ   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ โ
โ               โ                        โ
โ   โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโ โ
โ   โ  Actuator Controller            โ โ
โ   โ  - Up/Down movement             โ โ
โ   โ  - Position tracking            โ โ
โ   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
    โโโโโโโโโโโโโผโโโโโโโโโโโโฌโโโโโโโโโโโ
    โ           โ           โ          โ
โโโโโผโโโโ  โโโโโผโโโโ  โโโโโผโโโโโ โโโโผโโโ
โWS2812Bโ  โ Relay โ  โActuatorโ โRelayโ
โStrip 1โ  โ #1    โ  โ  12V   โ โ #2  โ
โโโโโโโโโ  โโโโโโโโโ  โโโโโโโโโโ โโโโโโโ
```

---

## ะัะพัะพะบะพะป ะบะพะผะฐะฝะด

### ะกัััะบัััะฐ ะบะพะผะฐะฝะดั (JSON)

```typescript
interface HardwareCommand {
  action: 'select_project' | 'reset' | 'screensaver' |
          'toggle_element' | 'highlight' | 'off' | 'actuator';
  projectId?: number;        // ID ะฟัะพะตะบัะฐ (0-27)
  target?: string;           // ะฆะตะปะตะฒะพะน ัะปะตะผะตะฝั (light, roof, landscape)
  state?: 'up' | 'down' | boolean;  // ะกะพััะพัะฝะธะต
  data?: {
    brightness?: number;     // ะฏัะบะพััั (0-255)
    color?: string;          // Hex ัะฒะตั (#FF0000)
    effect?: string;         // ะญััะตะบั (fade, pulse, rainbow)
    duration?: number;       // ะะปะธัะตะปัะฝะพััั ะฒ ะผั
  };
}
```

### ะัะธะผะตัั ะบะพะผะฐะฝะด

#### 1. ะะพะดัะฒะตัะธัั ะฟัะพะตะบั
```json
{
  "action": "highlight",
  "projectId": 9,
  "data": {
    "brightness": 200,
    "color": "#FFD700",
    "effect": "fade"
  }
}
```

#### 2. ะฃะฟัะฐะฒะปะตะฝะธะต ะฐะบััะฐัะพัะพะผ
```json
{
  "action": "actuator",
  "target": "roof",
  "state": "up"
}
```

#### 3. ะกะฑัะพั ะฒัะตะณะพ
```json
{
  "action": "reset"
}
```

---

## ะะพะฝัะธะณััะฐัะธั ะฟัะพะตะบัะพะฒ

ะะฐะถะดัะน ะฟัะพะตะบั ะธะผะตะตั `hardwareId` ะดะปั ัะฒัะทะธ ั ัะธะทะธัะตัะบะธะผ ะผะฐะบะตัะพะผ:

```typescript
// lib/data/projects.ts
export interface Project {
  id: string;
  name: string;
  hardwareId?: number;  // ะคะธะทะธัะตัะบะธะน ID ะฝะฐ ะบะพะฝััะพะปะปะตัะต (0-27)
  // ...
}
```

### ะะฐะฟะฟะธะฝะณ ะฟัะพะตะบัะพะฒ ะฝะฐ ัะฐัะดะฒะตั

| projectId | ะะฐะทะฒะฐะฝะธะต ะฟัะพะตะบัะฐ | LED Start | LED Count | ะะตะปะต | ะะบััะฐัะพั |
|-----------|------------------|-----------|-----------|------|----------|
| 0         | RAMS BEYOND      | 0         | 50        | -    | -        |
| 1         | RAMS CITY        | 50        | 30        | 1    | -        |
| 2         | NOMAD            | 80        | 20        | -    | -        |
| 9         | RAMS GARDEN      | 200       | 60        | 2    | 1        |
| 11        | RAMS SIGNATURE   | 300       | 50        | 3    | 2        |
| ...       | ...              | ...       | ...       | ...  | ...      |

---

## ะกะพััะพัะฝะธั ะธ ะปะพะณะธะบะฐ

### 1. **ะะตะถะธะผั ัะฐะฑะพัั**

#### Idle Mode (ะะถะธะดะฐะฝะธะต)
- ะัะต ะฟัะพะตะบัั ะฒัะบะปััะตะฝั
- Screensaver ะผะพะถะตั ะฑััั ะฐะบัะธะฒะตะฝ (ะฟะปะฐะฒะฝะฐั ะฐะฝะธะผะฐัะธั)

#### Project Highlight Mode
- ะะดะธะฝ ะฟัะพะตะบั ะฟะพะดัะฒะตัะตะฝ
- ะััะฐะปัะฝัะต ะทะฐัะตะผะฝะตะฝั ะธะปะธ ะฒัะบะปััะตะฝั
- ะะพะทะผะพะถะฝัะต ัััะตะบัั: fade in, pulse, rainbow

#### Demo Mode (Screensaver)
- ะฆะธะบะปะธัะตัะบะฐั ะฟะพะดัะฒะตัะบะฐ ะฟัะพะตะบัะพะฒ
- Rainbow ะธะปะธ wave ัััะตะบั ะฟะพ ะฒัะตะผ LED

### 2. **Debouncing ะธ ะพัะตัะตะดั ะบะพะผะฐะฝะด**

ะะตะฐะปะธะทะพะฒะฐะฝะพ ะฒ `WiFiHardwareService`:
- ะะพะผะฐะฝะดั ะดะตะฑะฐัะฝััััั ะฝะฐ 150ms
- ะัะธ ะฑััััะพะผ ะฟะตัะตะบะปััะตะฝะธะธ ะพัะผะตะฝัะตััั ะฟัะตะดัะดััะฐั ะบะพะผะฐะฝะดะฐ
- ะะพะผะฐะฝะดั ะฐะบััะฐัะพัะพะฒ ะฒัะฟะพะปะฝััััั ะฝะตะผะตะดะปะตะฝะฝะพ

---

## ะขะตัะฝะธัะตัะบะธะต ัะฟะตัะธัะธะบะฐัะธะธ

### ESP32 Pinout

| ะคัะฝะบัะธั           | GPIO Pin | ะขะธะฟ     | ะัะธะผะตัะฐะฝะธะต                  |
|-------------------|----------|---------|----------------------------|
| WS2812B Data      | GPIO 16  | Output  | 5V logic, level shifter    |
| Relay 1           | GPIO 17  | Output  | ะะบัะธะฒะฝัะน LOW               |
| Relay 2           | GPIO 18  | Output  | ะะบัะธะฒะฝัะน LOW               |
| Relay 3           | GPIO 19  | Output  | ะะบัะธะฒะฝัะน LOW               |
| Actuator Up       | GPIO 21  | Output  | ะงะตัะตะท H-Bridge ะธะปะธ ัะตะปะต    |
| Actuator Down     | GPIO 22  | Output  | ะงะตัะตะท H-Bridge ะธะปะธ ัะตะปะต    |
| Status LED        | GPIO 2   | Output  | ะัััะพะตะฝะฝัะน LED             |
| Button (optional) | GPIO 0   | Input   | Pullup, ะดะปั ัะตััะธัะพะฒะฐะฝะธั   |

### ะะธัะฐะฝะธะต

1. **ESP32**: 5V ะพั USB ะธะปะธ DC-DC converter
2. **WS2812B**: 5V, ัะพะบ ะทะฐะฒะธัะธั ะพั ะบะพะปะธัะตััะฒะฐ LED (50mA ะฝะฐ LED ะฟัะธ ะฟะพะปะฝะพะน ััะบะพััะธ)
   - 100 LED ร 50mA = 5A @ 5V
   - **ะะตะบะพะผะตะฝะดัะตััั**: ะัะดะตะปัะฝัะน ะะ 5V/10A
3. **ะะตะปะต**: 5V ะปะพะณะธะบะฐ, ะบะพะผะผััะธัััั 12V ะฝะฐะณััะทะบั
4. **ะะบััะฐัะพัั**: 12V, ัะพะบ ะทะฐะฒะธัะธั ะพั ะผะพะดะตะปะธ (ะพะฑััะฝะพ 2-5A)
   - **ะะตะบะพะผะตะฝะดัะตััั**: ะัะดะตะปัะฝัะน ะะ 12V/10A

### ะะตะทะพะฟะฐัะฝะพััั

- **ะะฟัะพะธะทะพะปััะธั**: ะะตะปะต ะผะพะดัะปะธ ะธะผะตัั ะฒัััะพะตะฝะฝัั ะพะฟัะพะฟะฐัั
- **ะะฐัะธัะฐ**: ะะธะพะดั ะพะฑัะฐัะฝะพะน ะฟะพะปััะฝะพััะธ ะฝะฐ ะฐะบััะฐัะพัะฐั
- **ะัะตะดะพััะฐะฝะธัะตะปะธ**: ะะฐ ะบะฐะถะดะพะน 12V ะปะธะฝะธะธ
- **WiFi**: WPA2 ัะธััะพะฒะฐะฝะธะต, ััะฐัะธัะตัะบะธะน IP

---

## ะะธะฑะปะธะพัะตะบะธ ะดะปั ESP32

### Arduino IDE / PlatformIO

```ini
[platformio]
platform = espressif32
framework = arduino

[env:esp32dev]
board = esp32dev
lib_deps =
    fastled/FastLED @ ^3.6.0
    me-no-dev/ESPAsyncWebServer @ ^1.2.3
    me-no-dev/AsyncTCP @ ^1.1.1
    bblanchon/ArduinoJson @ ^6.21.0
```

### ะะปััะตะฒัะต ะฑะธะฑะปะธะพัะตะบะธ

1. **FastLED**: ะฃะฟัะฐะฒะปะตะฝะธะต WS2812B
2. **ESPAsyncWebServer**: HTTP ัะตัะฒะตั
3. **ArduinoJson**: ะะฐััะธะฝะณ JSON ะบะพะผะฐะฝะด
4. **WiFi**: ะัััะพะตะฝะฝะฐั ะฑะธะฑะปะธะพัะตะบะฐ ESP32

---

## ะญััะตะบัั ะธ ะฐะฝะธะผะฐัะธะธ

### ะะพัััะฟะฝัะต ัััะตะบัั

1. **Fade In/Out**: ะะปะฐะฒะฝะพะต ะฒะบะปััะตะฝะธะต/ะฒัะบะปััะตะฝะธะต
2. **Pulse**: ะัะปััะฐัะธั ััะบะพััะธ
3. **Rainbow**: ะะฐะดัะถะฝัะน ัััะตะบั
4. **Wave**: ะะพะปะฝะฐ ัะฒะตัะฐ
5. **Sparkle**: ะะตััะฐะฝะธะต
6. **Chase**: ะะตะณััะธะน ะพะณะพะฝั

### ะะตะฐะปะธะทะฐัะธั ัััะตะบัะพะฒ

```cpp
void fadeIn(int projectId, CRGB color, int duration) {
  int startLed = projects[projectId].ledStart;
  int count = projects[projectId].ledCount;

  for (int brightness = 0; brightness <= 255; brightness += 5) {
    for (int i = 0; i < count; i++) {
      leds[startLed + i] = color;
      leds[startLed + i].fadeLightBy(255 - brightness);
    }
    FastLED.show();
    delay(duration / 51);  // 51 steps (0-255 by 5)
  }
}
```

---

## ะะธะฐะณะฝะพััะธะบะฐ ะธ ะพัะปะฐะดะบะฐ

### ะะฝะดะธะบะฐัะธั ััะฐัััะฐ

- **ะัััะพะตะฝะฝัะน LED (GPIO 2)**:
  - ะััััะพะต ะผะธะณะฐะฝะธะต: ะะพะดะบะปััะตะฝะธะต ะบ WiFi
  - ะะตะดะปะตะฝะฝะพะต ะผะธะณะฐะฝะธะต: ะะถะธะดะฐะฝะธะต ะบะพะผะฐะฝะด
  - ะะพััะพัะฝะฝะพ ะณะพัะธั: ะัะฟะพะปะฝะตะฝะธะต ะบะพะผะฐะฝะดั

### Serial Monitor

```cpp
Serial.begin(115200);
Serial.println("[INFO] ESP32 Hardware Controller Started");
Serial.print("[WIFI] IP Address: ");
Serial.println(WiFi.localIP());
```

### ะะพะณะธ ะฝะฐ ะบะปะธะตะฝัะต

```typescript
console.log('[Hardware WiFi] Command sent:', command.action);
console.warn('[Hardware WiFi] Hardware not available');
```

---

## ะะฐัััะฐะฑะธััะตะผะพััั

### ะะปั ะฑะพะปััะธั ัััะฐะฝะพะฒะพะบ

1. **ะะฝะพะถะตััะฒะตะฝะฝัะต ESP32**:
   - ะะฐะถะดัะน ESP32 ัะฟัะฐะฒะปัะตั ัะฒะพะตะน ะณััะฟะฟะพะน ะฟัะพะตะบัะพะฒ
   - ะะฐะทะฝัะต IP ะฐะดัะตัะฐ (192.168.1.100, 192.168.1.101, ...)
   - ะะปะธะตะฝั ัััะธั ะบะพะผะฐะฝะดั ะฝะฐ ะฝัะถะฝัะน ะบะพะฝััะพะปะปะตั

2. **MQTT ะฑัะพะบะตั** (ะพะฟัะธะพะฝะฐะปัะฝะพ):
   - ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะฐั ัะธััะตะผะฐ ัะพะพะฑัะตะฝะธะน
   - ะัััะต ะดะปั 10+ ะบะพะฝััะพะปะปะตัะพะฒ
   - Pub/Sub ะฐััะธัะตะบัััะฐ

3. **ะะพะปััะธะต LED ะผะฐััะธะฒั**:
   - ะะฐัะฐะปะปะตะปัะฝัะต ะปะธะฝะธะธ (FastLED ะฟะพะดะดะตัะถะธะฒะฐะตั ะดะพ 8 ะฟะฐัะฐะปะปะตะปัะฝัั)
   - ะะฝะตัะฝะธะน ะดัะฐะนะฒะตั ะฟะธัะฐะฝะธั ะดะปั ะบะฐะถะดัั 100-200 LED

---

## Troubleshooting

### ESP32 ะฝะต ะพัะฒะตัะฐะตั

1. ะัะพะฒะตัะธัั WiFi ัะพะตะดะธะฝะตะฝะธะต
2. Ping ESP32: `ping 192.168.1.100`
3. ะัะพะฒะตัะธัั Serial Monitor ะฝะฐ ะพัะธะฑะบะธ
4. ะะตัะตะทะฐะณััะทะธัั ESP32

### LED ะฝะต ัะฐะฑะพัะฐัั

1. ะัะพะฒะตัะธัั ะฟะธัะฐะฝะธะต 5V
2. ะัะพะฒะตัะธัั Data line ะฟะพะดะบะปััะตะฝะธะต
3. ะฃะผะตะฝััะธัั ััะบะพััั (ะฟะตัะตะณัะตะฒ/ะฝะตะดะพััะฐัะพัะฝัะน ัะพะบ)
4. ะะพะฑะฐะฒะธัั ัะตะทะธััะพั 470ฮฉ ะฝะฐ Data line

### ะะบััะฐัะพัั ะฝะต ะดะฒะธะณะฐัััั

1. ะัะพะฒะตัะธัั 12V ะฟะธัะฐะฝะธะต
2. ะัะพะฒะตัะธัั ัะตะปะต ััะฐะฑะฐััะฒะฐะฝะธะต (ะดะพะปะถะตะฝ ะฑััั ัะปััะตะฝ ัะตะปัะพะบ)
3. ะะทะผะตัะธัั ะฝะฐะฟััะถะตะฝะธะต ะฝะฐ ะฒััะพะดะต ัะตะปะต
4. ะัะพะฒะตัะธัั ะฟัะตะดะพััะฐะฝะธัะตะปะธ

### ะะพะผะฐะฝะดั ะฒัะฟะพะปะฝััััั ะผะตะดะปะตะฝะฝะพ

1. ะฃะผะตะฝััะธัั COMMAND_DEBOUNCE_MS
2. ะัะพะฒะตัะธัั WiFi ัะธะณะฝะฐะป
3. ะะฟัะธะผะธะทะธัะพะฒะฐัั ัััะตะบัั (ะผะตะฝััะต delay)

---

## ะกะปะตะดัััะธะต ัะฐะณะธ

1. โ ะััะธัะตะบัััะฐ ะพะฟัะตะดะตะปะตะฝะฐ
2. ๐ ะะฐะฟะธัะฐะฝะธะต ะฟัะพัะธะฒะบะธ ESP32
3. ๐ ะกัะตะผะฐ ะฟะพะดะบะปััะตะฝะธั
4. ๐ ะะพะฝัะธะณััะฐัะธั ะฟัะพะตะบัะพะฒ
5. ๐ ะขะตััะธัะพะฒะฐะฝะธะต ะธ ะบะฐะปะธะฑัะพะฒะบะฐ

---

## ะะพะฝัะฐะบัั

- **ะะพะบัะผะตะฝัะฐัะธั**: `/docs/`
- **ะััะพะดะฝะธะบะธ ะบะปะธะตะฝัะฐ**: `/lib/hardware/`
- **Firmware ESP32**: `/firmware/esp32/`

---

**ะะฐัะฐ ัะพะทะดะฐะฝะธั**: 2026-01-27
**ะะตััะธั**: 1.0
**ะะฒัะพั**: RAMS Interactive Hub Team
