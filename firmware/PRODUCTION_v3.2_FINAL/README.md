# RAMS Production Firmware v3.2 FINAL

**–î–∞—Ç–∞:** 2026-02-15
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û –ò –ü–†–û–®–ò–¢–û
**–ê–≤—Ç–æ—Ä:** RAMS Global Team

---

## üì¶ –°–æ—Å—Ç–∞–≤ –ø–∞–ø–∫–∏

```
PRODUCTION_v3.2_FINAL/
‚îú‚îÄ‚îÄ esp32/
‚îÇ   ‚îú‚îÄ‚îÄ rams_controller_v3.ino    - ESP32 –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ ACTUATOR_CONFIG.h         - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–ª–æ–∫–æ–≤
‚îú‚îÄ‚îÄ mega1/
‚îÇ   ‚îú‚îÄ‚îÄ actuator_mega1_v3.ino     - Arduino Mega #1 (–±–ª–æ–∫–∏ 1-8)
‚îÇ   ‚îî‚îÄ‚îÄ ACTUATOR_CONFIG.h         - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–ª–æ–∫–æ–≤
‚îú‚îÄ‚îÄ mega2/
‚îÇ   ‚îî‚îÄ‚îÄ actuator_mega2_v3.ino     - Arduino Mega #2 (–±–ª–æ–∫–∏ 9-15)
‚îú‚îÄ‚îÄ shared/
‚îÇ   ‚îî‚îÄ‚îÄ ACTUATOR_CONFIG.h         - –û–±—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md                      - –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### ESP32 (rams_controller_v3.ino)
- **–§—É–Ω–∫—Ü–∏—è:** –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å–∏—Å—Ç–µ–º—ã
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** 15 –∞–∫—Ç—É–∞—Ç–æ—Ä–Ω—ã—Ö –±–ª–æ–∫–æ–≤ + LED –∑–æ–Ω—ã
- **WiFi AP:** RAMS_Controller (–ø–∞—Ä–æ–ª—å: rams2026)
- **Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** http://192.168.4.1
- **Serial –ø–æ—Ä—Ç—ã:**
  - Serial1 (GPIO25 TX, GPIO26 RX) ‚Üí Mega #1
  - Serial2 (GPIO16 TX, GPIO17 RX) ‚Üí Mega #2
- **LED –ø–∏–Ω—ã:** GPIO 21,22,23,15,13,27,32,33,5,2 (10 –ª–µ–Ω—Ç)
- **–†–∞–∑–º–µ—Ä:** 847 KB (64% flash)

### Arduino Mega #1 (actuator_mega1_v3.ino)
- **–§—É–Ω–∫—Ü–∏—è:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏ 1-8
- **–ê–∫—Ç—É–∞—Ç–æ—Ä—ã:** 16 —à—Ç—É–∫ (8 –±–ª–æ–∫–æ–≤ √ó 2 –∞–∫—Ç—É–∞—Ç–æ—Ä–∞)
- **Serial –ø–æ—Ä—Ç:** Serial1 (TX1/RX1 pins 18/19) ‚Üí ESP32
- **–ü–∏–Ω—ã:** 22-53 (—Å–º. ACTUATOR_CONFIG.h)
- **–†–∞–∑–º–µ—Ä:** 8932 bytes (3% flash)

### Arduino Mega #2 (actuator_mega2_v3.ino)
- **–§—É–Ω–∫—Ü–∏—è:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏ 9-15
- **–ê–∫—Ç—É–∞—Ç–æ—Ä—ã:** 15 —à—Ç—É–∫ (6 –±–ª–æ–∫–æ–≤ √ó 2 + –±–ª–æ–∫ 15 √ó 3)
- **Serial –ø–æ—Ä—Ç:** Serial1 (TX1/RX1 pins 18/19) ‚Üí ESP32
- **–ü–∏–Ω—ã:** 22-53 (—Å–º. ACTUATOR_CONFIG.h)
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ë–ª–æ–∫ 15 –∏–º–µ–µ—Ç 3 –∞–∫—Ç—É–∞—Ç–æ—Ä–∞!

---

## üîå LED –ú–∞–ø–ø–∏–Ω–≥ (ESP32)

### –§–∏–∑–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- **8 –ª—É—á–µ–π:** 33 LED –∫–∞–∂–¥—ã–π (GPIO 21,22,23,15,13,27,32,33)
- **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—Ä—É–≥:** 64 LED (GPIO 5)
- **–í–Ω–µ—à–Ω–∏–π –∫—Ä—É–≥:** 150 LED (GPIO 2)

### –õ–æ–≥–∏–∫–∞ –±–ª–æ–∫–æ–≤:

**–í–ù–ï–®–ù–ò–ï –±–ª–æ–∫–∏ (1,3,5,7,9,11,13):**
- –í–Ω–µ—à–Ω—è—è —á–∞—Å—Ç—å –ª—É—á–µ–π (LED 18-32)
- –í–Ω–µ—à–Ω–∏–π –∫—Ä—É–≥

**–í–ù–£–¢–†–ï–ù–ù–ò–ï –±–ª–æ–∫–∏ (2,4,6,8,10,12,14):**
- –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —á–∞—Å—Ç—å –ª—É—á–µ–π (LED 0-17)
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—Ä—É–≥

**–ë–ª–æ–∫ 15 (–æ—Å–æ–±—ã–π):**
- –ü–û–õ–ù–´–ô –ª—É—á (LED 0-32)
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—Ä—É–≥
- –ë–ï–ó –≤–Ω–µ—à–Ω–µ–≥–æ –∫—Ä—É–≥–∞

### –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –¥–æ–ª–∏:
```
–ë–ª–æ–∫–∏ 1-2   ‚Üí –î–æ–ª—è 0 (–ª—É—á–∏ GPIO21-22)
–ë–ª–æ–∫–∏ 3-4   ‚Üí –î–æ–ª—è 1 (–ª—É—á–∏ GPIO22-23)
–ë–ª–æ–∫–∏ 5-6   ‚Üí –î–æ–ª—è 2 (–ª—É—á–∏ GPIO23-15)
–ë–ª–æ–∫–∏ 7-8   ‚Üí –î–æ–ª—è 3 (–ª—É—á–∏ GPIO15-13)
–ë–ª–æ–∫–∏ 9-10  ‚Üí –î–æ–ª—è 4 (–ª—É—á–∏ GPIO13-27)
–ë–ª–æ–∫–∏ 11-12 ‚Üí –î–æ–ª—è 5 (–ª—É—á–∏ GPIO27-32)
–ë–ª–æ–∫–∏ 13-14 ‚Üí –î–æ–ª—è 6 (–ª—É—á–∏ GPIO32-33)
–ë–ª–æ–∫ 15     ‚Üí –î–æ–ª—è 7 (–ª—É—á–∏ GPIO33-21)
```

---

## üì° –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏ (—Ç–µ–∫—Å—Ç–æ–≤—ã–π)

### –§–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥ (ESP32 ‚Üí Mega):
```
BLOCK:5:UP:10000    - –ë–ª–æ–∫ 5 –≤–≤–µ—Ä—Ö –Ω–∞ 10 —Å–µ–∫
BLOCK:3:DOWN:5000   - –ë–ª–æ–∫ 3 –≤–Ω–∏–∑ –Ω–∞ 5 —Å–µ–∫
BLOCK:7:STOP        - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–ª–æ–∫ 7
ALL:STOP            - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –±–ª–æ–∫–∏
PING                - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏
```

### –û—Ç–≤–µ—Ç—ã (Mega ‚Üí ESP32):
```
ACK:5:UP            - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
DONE:5              - –ë–ª–æ–∫ –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É
PONG                - –û—Ç–≤–µ—Ç –Ω–∞ –ø–∏–Ω–≥
ERROR:message       - –û—à–∏–±–∫–∞
```

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- **Baud rate:** 115200
- **–§–æ—Ä–º–∞—Ç:** 8N1
- **Heartbeat:** –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
- **Timeout:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ –≤—Ä–µ–º–µ–Ω–∏

---

## üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–æ—à–∏–≤–∫–µ

### ESP32:
```bash
cd esp32/
arduino-cli compile --fqbn esp32:esp32:esp32 rams_controller_v3.ino
arduino-cli upload -p /dev/cu.usbserial-0001 --fqbn esp32:esp32:esp32 rams_controller_v3.ino
```

### Arduino Mega #1:
```bash
cd mega1/
arduino-cli compile --fqbn arduino:avr:mega actuator_mega1_v3.ino
arduino-cli upload -p /dev/cu.usbmodem141021 --fqbn arduino:avr:mega actuator_mega1_v3.ino
```

### Arduino Mega #2:
```bash
cd mega2/
# –°–Ω–∞—á–∞–ª–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ACTUATOR_CONFIG.h –∏–∑ shared/
cp ../shared/ACTUATOR_CONFIG.h .
# –ò–∑–º–µ–Ω–∏—Ç—å include –≤ .ino —Ñ–∞–π–ª–µ –Ω–∞: #include "ACTUATOR_CONFIG.h"
arduino-cli compile --fqbn arduino:avr:mega actuator_mega2_v3.ino
arduino-cli upload -p /dev/cu.usbserial-XXXX --fqbn arduino:avr:mega actuator_mega2_v3.ino
```

---

## üéÆ Web API (ESP32)

### Endpoints:

**GET /** - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º

**GET /api/status** - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
```json
{
  "active": 2,
  "blocks": [1, 5]
}
```

**POST /api/block** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–º
```
?num=5&action=UP&duration=10000
```

**POST /api/stop** - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –±–ª–æ–∫–∏

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∏–Ω–æ–≤ (ACTUATOR_CONFIG.h)

### –ë–ª–æ–∫ 1-8 (Mega #1):
| –ë–ª–æ–∫ | –ê–∫—Ç.1 UP | –ê–∫—Ç.1 DOWN | –ê–∫—Ç.2 UP | –ê–∫—Ç.2 DOWN |
|------|----------|------------|----------|------------|
| 1    | 22       | 23         | 24       | 25         |
| 2    | 26       | 27         | 28       | 29         |
| 3    | 30       | 31         | 32       | 33         |
| 4    | 34       | 35         | 36       | 37         |
| 5    | 38       | 39         | 40       | 41         |
| 6    | 50       | 51         | 52       | 53         |
| 7    | 42       | 43         | 44       | 45         |
| 8    | 46       | 47         | 48       | 49         |

### –ë–ª–æ–∫ 9-15 (Mega #2):
| –ë–ª–æ–∫ | –ê–∫—Ç.1 UP | –ê–∫—Ç.1 DOWN | –ê–∫—Ç.2 UP | –ê–∫—Ç.2 DOWN | –ê–∫—Ç.3 UP | –ê–∫—Ç.3 DOWN |
|------|----------|------------|----------|------------|----------|------------|
| 9    | 22       | 23         | 24       | 25         | -        | -          |
| 10   | 26       | 27         | 28       | 29         | -        | -          |
| 11   | 30       | 31         | 32       | 33         | -        | -          |
| 12   | 34       | 35         | 36       | 37         | -        | -          |
| 13   | 38       | 39         | 40       | 41         | -        | -          |
| 14   | 50       | 51         | 52       | 53         | -        | -          |
| 15   | 42       | 43         | 44       | 45         | 46       | 47         |

### –õ–æ–≥–∏–∫–∞ —Ä–µ–ª–µ:
- **RELAY_ON = LOW** (–∏–Ω–≤–µ—Ä—Å–Ω–∞—è –ª–æ–≥–∏–∫–∞!)
- **RELAY_OFF = HIGH**

---

## ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v3.2 (2026-02-15) - FINAL
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π LED –º–∞–ø–ø–∏–Ω–≥ –¥–ª—è –≤—Å–µ—Ö 15 –±–ª–æ–∫–æ–≤
- ‚úÖ OUTER –±–ª–æ–∫–∏ (1,3,5,7,9,11,13,15): –≤–Ω–µ—à–Ω—è—è —á–∞—Å—Ç—å + –≤–Ω–µ—à–Ω–∏–π –∫—Ä—É–≥
- ‚úÖ INNER –±–ª–æ–∫–∏ (2,4,6,8,10,12,14): –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —á–∞—Å—Ç—å + –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—Ä—É–≥
- ‚úÖ –ë–ª–æ–∫ 15: –ø–æ–ª–Ω—ã–π –ª—É—á + –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—Ä—É–≥, –ë–ï–ó –≤–Ω–µ—à–Ω–µ–≥–æ
- ‚úÖ DroneControl style –∫–æ–¥ (–≤—Å–µ –≤ loop, –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π)
- ‚úÖ –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª (–±—ã—Å—Ç—Ä—ã–π sscanf –ø–∞—Ä—Å–∏–Ω–≥)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ACTUATOR_CONFIG.h
- ‚úÖ –£—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–∏—Ç–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –ü—Ä–æ—à–∏—Ç—å –≤—Å–µ 3 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤—ã—à–µ)
2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å Serial –∫–∞–±–µ–ª–∏: ESP32 ‚Üî Mega #1, ESP32 ‚Üî Mega #2
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å LED –ª–µ–Ω—Ç—ã –∫ ESP32 (GPIO 21,22,23,15,13,27,32,33,5,2)
4. –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∞–∫—Ç—É–∞—Ç–æ—Ä—ã –∫ Mega –ø–ª–∞—Ç–∞–º (—Å–º. —Ç–∞–±–ª–∏—Ü—É –ø–∏–Ω–æ–≤)
5. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ WiFi "RAMS_Controller" (–ø–∞—Ä–æ–ª—å: rams2026)
6. –û—Ç–∫—Ä—ã—Ç—å http://192.168.4.1
7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–∞–∫—Å–∏–º—É–º 2 –∞–∫—Ç–∏–≤–Ω—ã—Ö –±–ª–æ–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π timeout –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- Heartbeat –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ ACTUATOR_CONFIG.h

---

**üéâ PRODUCTION READY!**
