# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: Windows .exe –ù–ï –ó–ê–ü–£–°–ö–ê–õ–°–Ø

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê

**–ß—Ç–æ –±—ã–ª–æ:**
- Windows .exe —Ñ–∞–π–ª —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è —É—Å–ø–µ—à–Ω–æ
- –ü–æ—è–≤–ª—è–ª–∞—Å—å –∏–∫–æ–Ω–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
- –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∏–∫–æ–Ω–∫—É ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ
- –û–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª–æ—Å—å
- –ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –Ω–µ –±—ã–ª–æ –≤–∏–¥–Ω–æ

## üîç –ü–†–ò–ß–ò–ù–ê

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**

–°—Ç–∞—Ä—ã–π –∫–æ–¥ –≤ `electron/main.js` (—Å—Ç—Ä–æ–∫–∏ 26-30) –ø—ã—Ç–∞–ª—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å Next.js –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

```javascript
const nextPath = path.join(__dirname, '..', 'node_modules', '.bin', 'next');
nextServer = spawn(nextPath, ['start'], {
  cwd: path.join(__dirname, '..'),
  env: { ...process.env, PORT: '3000' }
});
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ:**

1. **ASAR –∞—Ä—Ö–∏–≤** - Electron —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –≤ `.asar` –∞—Ä—Ö–∏–≤
2. **–ù–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞** - `node_modules/.bin/next` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –≤ ASAR
3. **spawn() –Ω–µ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å** - –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç
4. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–∏—Å–∏—Ç** - –∂–¥—ë—Ç 5 —Å–µ–∫—É–Ω–¥ (timeout) –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**

### 1. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Next.js —Å–µ—Ä–≤–µ—Ä

–í–º–µ—Å—Ç–æ `spawn()` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Next.js:

```javascript
const next = require('next');
const http = require('http');

nextApp = next({
  dev: false,
  dir: appDir,
  conf: {
    distDir: '.next',
  }
});

await nextApp.prepare();

const handle = nextApp.getRequestHandler();
server = http.createServer((req, res) => {
  handle(req, res);
});

server.listen(3000);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ —É–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–º Electron –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –ù–∞–¥—ë–∂–Ω—ã–π –∑–∞–ø—É—Å–∫
- ‚úÖ –õ—É—á—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 2. –î–∏–∞–ª–æ–≥ –æ—à–∏–±–æ–∫

–î–æ–±–∞–≤–ª–µ–Ω–æ –æ–∫–Ω–æ —Å –æ—à–∏–±–∫–æ–π –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥—ë—Ç –Ω–µ —Ç–∞–∫:

```javascript
dialog.showErrorBox(
  'Startup Error',
  `Failed to start the application:\n\n${error.message}\n\nPlease check the logs or contact support.`
);
```

–¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Å–ª–æ–º–∞–ª–æ—Å—å!

### 3. ASAR Unpack –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ `package.json`:

```json
"asarUnpack": [
  "**/*.node",
  ".next/**/*",
  "node_modules/next/**/*"
],
"files": [
  "node_modules/next/**/*"
]
```

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ:
- Next.js —Ñ–∞–π–ª—ã —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω—ã (–Ω–µ –≤ ASAR)
- –ù–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ (*.node) –¥–æ—Å—Ç—É–ø–Ω—ã
- Next.js –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å —Å–≤–æ–∏ —Ñ–∞–π–ª—ã

### 4. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω—ã console.log –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```javascript
console.log('[PROD] Starting embedded Next.js server...');
console.log(`[PROD] App directory: ${appDir}`);
console.log(`[PROD] Found .next build at: ${nextDir}`);
console.log('[PROD] Next.js app prepared');
console.log('[PROD] Next.js server ready on http://localhost:3000');
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤–∏–¥–µ—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞!

---

## üì• –ö–ê–ö –ü–û–õ–£–ß–ò–¢–¨ –ò–°–ü–†–ê–í–õ–ï–ù–ù–£–Æ –í–ï–†–°–ò–Æ

### –í–∞—Ä–∏–∞–Ω—Ç 1: GitHub Actions (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

1. **–û—Ç–∫—Ä–æ–π GitHub Actions:**
   ```
   https://github.com/nurdamiron/rams-projects/actions
   ```

2. **–ù–∞–π–¥–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π build:**
   - –°–º–æ—Ç—Ä–∏ –Ω–∞ commit: "Fix Windows .exe launch issue - use embedded Next.js server"
   - –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å üü¢ –∑–µ–ª—ë–Ω—ã–π (–∏–ª–∏ üü° –∂—ë–ª—Ç—ã–π = –µ—â—ë —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è)

3. **–î–æ–∂–¥–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**
   - –ó–∞–π–º—ë—Ç ~10-15 –º–∏–Ω—É—Ç
   - –°–ª–µ–¥–∏ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º

4. **–°–∫–∞—á–∞–π –Ω–æ–≤—ã–π .exe:**
   - –ö–ª–∏–∫–Ω–∏ –Ω–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—É—é —Å–±–æ—Ä–∫—É
   - –í–Ω–∏–∑—É: "Artifacts"
   - –°–∫–∞—á–∞–π: `windows-executables.zip`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ (–µ—Å–ª–∏ —Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–æ)

```bash
cd /Users/nurdauletakhmatov/Desktop/rams-screen/rams-interactive-hub/rams-interactive-hub

# –ü–æ–ª—É—á–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –°–æ–±–µ—Ä–∏
npm run build
npm run electron:build

# –ó–∞–±–µ—Ä–∏ —Ñ–∞–π–ª—ã –∏–∑ dist/
```

**–ù–û:** –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ç–æ–ª—å–∫–æ Mac –≤–µ—Ä—Å–∏—é! –î–ª—è Windows –∏—Å–ø–æ–ª—å–∑—É–π GitHub Actions.

---

## üß™ –ö–ê–ö –¢–ï–°–¢–ò–†–û–í–ê–¢–¨ –ù–û–í–£–Æ –í–ï–†–°–ò–Æ

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏/–ó–∞–ø—É—Å—Ç–∏

**Setup installer:**
```
1. –ó–∞–ø—É—Å—Ç–∏ RAMS Interactive Hub Setup 0.1.0.exe
2. –°–ª–µ–¥—É–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
3. –ó–∞–ø—É—Å—Ç–∏ —Å —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞
```

**Portable –≤–µ—Ä—Å–∏—è:**
```
1. –ü–æ–ª–æ–∂–∏ RAMS-Interactive-Hub-Portable.exe –≤ C:\RAMS\
2. –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫
```

### –®–∞–≥ 2: –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏

‚úÖ **–£–°–ü–ï–•:**
- –ü–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (fullscreen)
- –£–≤–∏–¥–∏—à—å –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (screensaver –∏–ª–∏ gallery)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

‚ùå **–û–®–ò–ë–ö–ê:**
- –ü–æ—è–≤–∏—Ç—Å—è –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ: "Startup Error"
- –ë—É–¥–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–æ —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–µ —Ç–∞–∫
- –°—Ñ–æ—Ç–∫–∞–π/—Å–∫–æ–ø–∏—Ä—É–π —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–∏

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å –º–µ–¥–∏–∞

```
C:\RAMS\
‚îú‚îÄ‚îÄ RAMS-Interactive-Hub-Portable.exe
‚îî‚îÄ‚îÄ media\
    ‚îî‚îÄ‚îÄ projects\
        ‚îî‚îÄ‚îÄ (—Ç–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã)
```

–ï—Å–ª–∏ –º–µ–¥–∏–∞-—Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ ‚Äî –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è!

---

## üêõ –ï–°–õ–ò –í–°–Å –ï–©–Å –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∏–∞–ª–æ–≥ "Startup Error"

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°—Ñ–æ—Ç–∫–∞–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
2. –û—Ç–ø—Ä–∞–≤—å –º–Ω–µ
3. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
   ```cmd
   cd C:\RAMS
   RAMS-Interactive-Hub-Portable.exe
   ```
4. –°–∫–æ–ø–∏—Ä—É–π –≤–µ—Å—å –≤—ã–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏

### –ü—Ä–æ–±–ª–µ–º–∞: Windows Defender –±–ª–æ–∫–∏—Ä—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Windows
2. –ó–∞—â–∏—Ç–∞ –æ—Ç –≤–∏—Ä—É—Å–æ–≤ –∏ —É–≥—Ä–æ–∑
3. –ò—Å–∫–ª—é—á–µ–Ω–∏—è ‚Üí –î–æ–±–∞–≤–∏—Ç—å –ø–∞–ø–∫—É `C:\RAMS\`

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç 3000 –∑–∞–Ω—è—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```cmd
netstat -ano | findstr :3000
```

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç 3000 ‚Äî —É–±–µ–π –ø—Ä–æ—Ü–µ—Å—Å:
```cmd
taskkill /PID <–Ω–æ–º–µ—Ä_–ø—Ä–æ—Ü–µ—Å—Å–∞> /F
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –æ–∫–Ω–∞, –Ω–æ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```cmd
tasklist | findstr "RAMS"
```

–ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –µ—Å—Ç—å –Ω–æ –æ–∫–Ω–∞ –Ω–µ—Ç:
```cmd
taskkill /IM "RAMS-Interactive-Hub-Portable.exe" /F
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏ —Å–Ω–æ–≤–∞.

---

## üìã –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:

1. **`electron/main.js`** - –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ startNextServer()
   - –£–±—Ä–∞–Ω spawn()
   - –î–æ–±–∞–≤–ª–µ–Ω embedded Next.js server
   - –î–æ–±–∞–≤–ª–µ–Ω dialog.showErrorBox()
   - –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

2. **`package.json`** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è build
   - –î–æ–±–∞–≤–ª–µ–Ω `node_modules/next/**/*` –≤ files
   - –î–æ–±–∞–≤–ª–µ–Ω `asarUnpack` –¥–ª—è Next.js
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ Next.js –Ω–µ —Å–ª–æ–º–∞–µ—Ç—Å—è –≤ ASAR

### Commit:

```
commit d3ed730
Author: RAMS Global
Date: 2025-01-27

Fix Windows .exe launch issue - use embedded Next.js server
```

---

## ‚úÖ –ò–¢–û–ì–û

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
1. ‚úÖ Windows .exe —Ç–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. ‚úÖ Next.js —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ production build
3. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ—à–∏–±–∫–∏ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫
4. ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–ß—Ç–æ –¥–∞–ª—å—à–µ:**
1. –°–∫–∞—á–∞–π –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Å GitHub Actions
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –Ω–∞ Windows
3. –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –¥–æ–±–∞–≤—å –º–µ–¥–∏–∞-—Ñ–∞–π–ª—ã
4. –ì–æ—Ç–æ–≤–æ! üéâ

**–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:**
- –û—Ç–ø—Ä–∞–≤—å —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏
- –ò–ª–∏ –ª–æ–≥ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
- –†–∞–∑–±–µ—Ä—ë–º—Å—è!

---

**–£–¥–∞—á–∏!** üöÄ
