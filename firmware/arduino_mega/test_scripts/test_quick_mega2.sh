#!/bin/bash

# –ë–´–°–¢–†–´–ô –¢–ï–°–¢ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ Mega #2 (9-15)
# –ö–æ—Ä–æ—Ç–∫–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

PORT="/dev/cu.usbmodem141021"
BAUD="115200"

echo "=========================================="
echo "  üöÄ –ë–´–°–¢–†–´–ô –¢–ï–°–¢ MEGA #2 (9-15)"
echo "=========================================="

send_cmd() {
    echo "[‚Üí] $1"
    echo "$1" > "$PORT"
    sleep 0.2
}

stty -f "$PORT" "$BAUD"
sleep 2

echo ""
echo "–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã..."
sleep 2

# –¶–ò–ö–õ: 10 —Å–µ–∫ –≤–≤–µ—Ä—Ö, 2 —Å–µ–∫ –ø–∞—É–∑–∞, 10 —Å–µ–∫ –≤–Ω–∏–∑, 2 —Å–µ–∫ –ø–∞—É–∑–∞
for block in {9..15}; do
    echo ""
    echo "‚ïê‚ïê‚ïê –ë–õ–û–ö $block ‚ïê‚ïê‚ïê"

    # –í–≤–µ—Ä—Ö
    send_cmd "{\"block\":$block,\"action\":\"up\",\"duration\":10000}"
    sleep 12

    # –í–Ω–∏–∑
    send_cmd "{\"block\":$block,\"action\":\"down\",\"duration\":10000}"
    sleep 12

    echo "‚úì –ë–ª–æ–∫ $block"
done

echo ""
echo "=========================================="
echo "  ‚úÖ –¢–ï–°–¢ –ó–ê–í–ï–†–®–Å–ù!"
echo "=========================================="
